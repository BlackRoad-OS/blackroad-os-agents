{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://blackroad.schemas/agent.schema.json",
  "title": "BlackRoad Agent Schema",
  "type": "object",
  "properties": {
    "id": { "type": "string", "pattern": "^[a-z0-9-]+$" },
    "display_name": { "type": "string", "minLength": 1 },
    "role_archetype": { "type": "string", "minLength": 1 },
    "org_layer": { "type": "string", "enum": ["system", "leadership", "utility", "experimental"] },
    "personality": { "$ref": "https://blackroad.schemas/persona.schema.json" },
    "capabilities": {
      "type": "array",
      "items": { "type": "string" },
      "minItems": 1,
      "uniqueItems": true
    },
    "identity": {
      "type": "object",
      "properties": {
        "ps_sha_infinity": { "type": "string", "pattern": "^pssha‚àû:br:[a-z0-9-]+:[A-Za-z0-9+/=:-]+$" },
        "version": { "type": "integer", "minimum": 1 }
      },
      "required": ["ps_sha_infinity", "version"],
      "additionalProperties": false
    },
    "policy_profile": {
      "type": "object",
      "properties": {
        "risk_band": { "type": "string", "enum": ["low", "medium", "high"] },
        "allowed_domains": {
          "type": "array",
          "items": { "type": "string" },
          "minItems": 1,
          "uniqueItems": true
        },
        "prohibited_actions": {
          "type": "array",
          "items": { "type": "string" },
          "uniqueItems": true
        }
      },
      "required": ["risk_band", "allowed_domains", "prohibited_actions"],
      "additionalProperties": false
    },
    "policy_hooks": {
      "type": "array",
      "items": { "$ref": "https://blackroad.schemas/policy-hook.schema.json" }
    },
    "suitability_profile": {
      "type": "object",
      "properties": {
        "ideal_context": {
          "type": "array",
          "items": { "type": "string" },
          "minItems": 1,
          "uniqueItems": true
        },
        "anti_patterns": {
          "type": "array",
          "items": { "type": "string" },
          "minItems": 1,
          "uniqueItems": true
        }
      },
      "required": ["ideal_context", "anti_patterns"],
      "additionalProperties": false
    },
    "owner": { "type": "string", "minLength": 1 },
    "home_repo": { "type": "string", "minLength": 1 },
    "lifecycle": { "type": "string", "enum": ["active", "deprecated", "stub"] }
  },
  "required": [
    "id",
    "display_name",
    "role_archetype",
    "org_layer",
    "personality",
    "capabilities",
    "identity",
    "policy_profile",
    "suitability_profile",
    "owner",
    "home_repo",
    "lifecycle"
  ],
  "additionalProperties": false
  "$id": "https://blackroad.systems/schemas/agent.schema.json",
  "title": "BlackRoad OS Agent Schema",
  "description": "ü§ñüß¨ Schema for defining agents in the BlackRoad OS agent swarm",
  "type": "object",
  "required": ["id", "display_name", "pack_id", "role", "risk_level", "capabilities", "status"],
  "properties": {
    "id": {
      "type": "string",
      "pattern": "^agent\\.[a-z0-9-]+\\.[a-z0-9-]+$",
      "description": "Unique agent identifier (e.g., agent.lucidia.core)"
    },
    "display_name": {
      "type": "string",
      "minLength": 1,
      "maxLength": 100,
      "description": "Human-readable display name"
    },
    "pack_id": {
      "type": "string",
      "pattern": "^pack\\.[a-z0-9-]+$",
      "description": "ID of the owning pack (e.g., pack.finance)"
    },
    "role": {
      "type": "string",
      "minLength": 1,
      "maxLength": 500,
      "description": "Short description of the agent's role"
    },
    "persona": {
      "type": "string",
      "maxLength": 2000,
      "description": "Extended persona/personality description"
    },
    "risk_level": {
      "type": "string",
      "enum": ["low", "medium", "high"],
      "description": "‚ö†Ô∏è Risk classification for this agent"
    },
    "capabilities": {
      "type": "array",
      "items": {
        "type": "string",
        "enum": [
          "read-only",
          "suggest-only",
          "execute-with-approval",
          "execute-autonomous",
          "admin"
        ]
      },
      "minItems": 1,
      "description": "üß≠ List of capability scopes for this agent"
    },
    "skills": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Specific skills/functions this agent can perform"
    },
    "allowed_workflows": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "‚öôÔ∏è Workflow IDs this agent is allowed to invoke"
    },
    "disallowed_zones": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "üö´ Zones/areas this agent must never touch"
    },
    "repos": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Repositories this agent can access"
    },
    "environments": {
      "type": "array",
      "items": {
        "type": "string",
        "enum": ["dev", "staging", "prod", "lab"]
      },
      "description": "Environments this agent can operate in"
    },
    "permissions": {
      "type": "object",
      "additionalProperties": {
        "type": "string",
        "enum": ["none", "read", "write", "admin"]
      },
      "description": "Service-specific permission levels"
    },
    "escalation_path": {
      "type": "string",
      "description": "Who/what to escalate to when this agent needs help"
    },
    "logging": {
      "type": "object",
      "properties": {
        "level": {
          "type": "string",
          "enum": ["debug", "info", "warn", "error"]
        },
        "archive": {
          "type": "boolean",
          "description": "Whether actions should be archived in blackroad-os-archive"
        },
        "alert_channels": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Channels to notify on important events"
        }
      }
    },
    "dashboard_views": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "üïπÔ∏è Dashboard/view IDs in prism-console"
    },
    "status": {
      "type": "string",
      "enum": ["active", "inactive", "deprecated", "pending_approval"],
      "description": "Current operational status"
    },
    "requires_approval": {
      "type": "boolean",
      "default": false,
      "description": "Whether actions require explicit approval"
    },
    "high_risk_marker": {
      "type": "string",
      "description": "Required comment marker for high-risk agents. Should be set to '// HIGH-RISK AGENT ‚Äì STRONG GUARDRAILS REQUIRED' when the agent has risk_level 'high' or can access sensitive zones (finance, identity, legal, infrastructure). This marker serves as documentation and audit trail for security-sensitive agents."
    },
    "created_at": {
      "type": "string",
      "format": "date-time"
    },
    "updated_at": {
      "type": "string",
      "format": "date-time"
    }
  },
  "if": {
    "properties": {
      "risk_level": {
        "const": "high"
      }
    }
  },
  "then": {
    "required": ["requires_approval", "escalation_path", "disallowed_zones"],
    "properties": {
      "requires_approval": {
        "const": true
      }
    }
  }
}
